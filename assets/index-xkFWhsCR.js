(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const A=20,I=.02,S=6,D=.01,E=["#F7FF5F","#FCA86C","#FF7373","#DD7CB7","#BA85FF","#9BCEC0","#87FF97","#82F7CD","#7DF0FF"],P=(e,t)=>t[e%t.length],G=(e,t)=>(e+1)%t.length,k=(e,t)=>({column:e,row:t}),q=(e,t,n,o)=>({column:e,row:t,radius:n,colour:o}),B=(e,t)=>{const n=Math.max(0,e-I),o=Math.sqrt(n)*S;return Math.min(t/2,o)},H=e=>e>D,U=(e,t,n)=>{const o=t-e.column,r=n-e.row;return Math.hypot(o,r)<=e.radius},L=e=>Math.min(1,Math.max(0,e)),M=(e,t)=>t===0?0:e/t,b=(e,t,n)=>({x:e,y:t,inside:n}),O=()=>b(0,0,!1),V=e=>()=>e.getBoundingClientRect(),N=e=>t=>{const n=e(),o=t.clientX-n.left,r=t.clientY-n.top,s=L(M(o,n.width)),c=L(M(r,n.height));return b(s,c,!0)},_=(e,t)=>{if(!e.inside)return null;const n=Math.min(t-1,Math.floor(e.x*t)),o=Math.min(t-1,Math.floor(e.y*t));return k(n,o)},R=(e,t)=>{const n=e.getBoundingClientRect(),o=window.devicePixelRatio||1;return e.width=n.width*o,e.height=n.height*o,t.setTransform(1,0,0,1,0,0),t.scale(o,o),{width:n.width,height:n.height}},W=(e,t)=>(n,o)=>{const{width:r,height:s}=n,c=r/t,i=s/t;e.clearRect(0,0,r,s);const l="#2a2a2a",a=o?o.colour:"#3a3a3a";for(let u=0;u<t;u+=1)for(let d=0;d<t;d+=1){const f=o&&U(o,d,u);e.fillStyle=f?a:l,e.fillRect(d*c,u*i,c,i)}},X=(e,t)=>(n,o)=>{if(!o)return;const{width:r,height:s}=n,c=r/t,i=s/t,l=o.column*c,a=o.row*i,u=l+c,d=a+i,f=(l+u)/2,m=(a+d)/2,h=Math.min(c,i)*.02,v=Math.min(c,i)*.18;e.save(),e.strokeStyle=o.colour,e.lineWidth=h,e.lineCap="butt",e.lineJoin="miter",e.strokeRect(l+h/2,a+h/2,c-h,i-h),e.beginPath(),e.moveTo(l+v,m),e.lineTo(u-v,m),e.stroke(),e.beginPath(),e.moveTo(f,a+v),e.lineTo(f,d-v),e.stroke(),e.restore()},Y=(e,t)=>{if(!e&&!t)return!0;if(!e||!t)return!1;const n=e.column===t.column&&e.row===t.row,o=Math.abs(e.radius-t.radius)<D,r=e.colour===t.colour;return n&&o&&r},K=(e,t)=>{if(!e&&!t)return!0;if(!e||!t)return!1;const n=e.column===t.column&&e.row===t.row,o=e.colour===t.colour;return n&&o},Z=(e,t,n)=>{const o=e.getContext("2d");if(!o)return()=>{};const r=W(o,t),s=X(o,t);let c=R(e,o),i=null,l=null;const a=()=>{r(c,i),s(c,l)},u=(f,m,h,v)=>{const g=_(f,t),w=g?B(m,t):0,p=P(h,n),C=g&&H(w)?q(g.column,g.row,w,p):null,y=v&&g?{column:g.column,row:g.row,colour:p}:null;Y(i,C)&&K(l,y)||(i=C,l=y,a())},d=()=>{c=R(e,o),a()};return window.addEventListener("resize",d),a(),u},J=(e,t)=>{const n=V(e),o=N(n),r=c=>t(o(c)),s=()=>t(O());return e.addEventListener("mousemove",r),e.addEventListener("mouseleave",s),()=>{e.removeEventListener("mousemove",r),e.removeEventListener("mouseleave",s)}},F=e=>document.querySelector(e),j=e=>{const t=document.createElement("span");return t.id="cursor-position",e.append(t),t},Q=e=>{e.textContent=""},$=e=>{const t=e.reduce((n,o)=>{const r=(o-128)/128;return n+r*r},0);return Math.sqrt(t/e.length)},z=e=>{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return()=>{};const t=new AudioContext,n=()=>t.resume();document.addEventListener("click",n,{once:!0}),document.addEventListener("touchstart",n,{once:!0});let o=null,r=()=>{};return navigator.mediaDevices.getUserMedia({audio:!0}).then(s=>{const c=t.createMediaStreamSource(s),i=t.createAnalyser();i.fftSize=256;const l=new Uint8Array(i.fftSize);c.connect(i);const a=()=>{i.getByteTimeDomainData(l),e($(l)),o=requestAnimationFrame(a)};a(),r=()=>{o&&cancelAnimationFrame(o),i.disconnect(),c.disconnect(),s.getTracks().forEach(u=>u.stop()),t.close()}}).catch(()=>{}),()=>r()},x=()=>{const e=n=>n.preventDefault(),t={passive:!1};return window.addEventListener("gesturestart",e,t),window.addEventListener("gesturechange",e,t),window.addEventListener("gestureend",e,t),()=>{window.removeEventListener("gesturestart",e,t),window.removeEventListener("gesturechange",e,t),window.removeEventListener("gestureend",e,t)}},T=(e,t)=>e.toLowerCase()===t,ee=e=>T(e,"c"),te=e=>T(e,"d"),oe=()=>{const e=F("#grid-canvas"),t=F("#control-panel");if(!e||!t)return;const n=Z(e,A,E);let o=O(),r=0,s=0,c=!1;const i=j(t),l=()=>{Q(i)},a=()=>{n(o,r,s,c)},u=J(t,m=>{o=m,l(),a()}),d=z(m=>{r=m,a()}),f=x();window.addEventListener("keydown",m=>{const{key:h}=m;if(ee(h)){s=G(s,E),a();return}te(h)&&(c=!c,a())}),window.addEventListener("beforeunload",()=>{d(),f(),u()},{once:!0}),l(),a()};oe();
